<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Student Result</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f5f7fa;
    text-align: center;
    padding: 20px;
  }
  .card {
    background: white;
    border-radius: 10px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    max-width: 600px;
    margin: 0 auto;
    padding: 30px;
  }
  h2 { color: #222; }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
  }
  th, td {
    padding: 10px;
    border: 1px solid #ddd;
  }
  th {
    background: #007BFF;
    color: white;
  }
</style>
</head>
<body>
  <div class="card">
    <h2>Student Result</h2>
    <div id="result"></div>
  </div>

  <script>
    async function loadResult() {
      const params = new URLSearchParams(window.location.search);
      const studentId = (params.get("id") || "").trim().toLowerCase();

      if (!studentId) {
        document.getElementById("result").innerHTML = "<p>No Student ID provided.</p>";
        return;
      }

      try {
        const response = await fetch("https://raw.githubusercontent.com/OSIFBD/Test/main/data.json");
        const data = await response.json();

        // Case-insensitive match
        const student = data.find(s => 
          (s.studentId || "").toString().trim().toLowerCase() === studentId
        );

        if (!student) {
          document.getElementById("result").innerHTML = "<p>No result found for this Student ID.</p>";
          return;
        }

        // Build HTML
        const subjects = student.subjects?.map((subj, i) => 
          `<tr><td>${subj}</td><td>${student.marks[i]}</td></tr>`
        ).join('') || '';

        document.getElementById("result").innerHTML = `
          <p><strong>Name:</strong> ${student.name}</p>
          <p><strong>Father's Name:</strong> ${student.fatherName}</p>
          <p><strong>Course:</strong> ${student.course}</p>
          <p><strong>Date of Issue:</strong> ${student.dateOfIssue}</p>
          <table>
            <tr><th>Subject</th><th>Marks</th></tr>
            ${subjects}
          </table>
          <p><strong>Total:</strong> ${student.total}/${student.outOf}</p>
          <p><strong>Grade:</strong> ${student.grade}</p>
          <br>
          <a href="certificate.html?id=${student.studentId}" target="_blank">View Certificate</a>
        `;
      } catch (err) {
        document.getElementById("result").innerHTML = "<p>Error loading data.</p>";
        console.error(err);
      }
    }

    loadResult();
  </script>
</body>
</html>
